import cv2
import numpy as np
import glob

#两组2d坐标转换  得到转换矩阵
matrix1 = np.array([[1034.7388916 ,  684.09613037], [772.74993896,   689.4161377], [509.26437378,   693.92810059 ],[1030.6295166 ,   527.36096191], [769.69049072,   531.95776367], [506.98348999,   536.55010986],[1024.79992676,   319.84289551], [765.5489502 ,   323.61978149], [504.41970825,   328.69494629]])
matrix2 = np.array([[612.867,-65.59], [862.01,-69.66], [1113.16,-72.96],[614.92,83.25], [ 864.25,79.43], [1114.93,75.06],[ 618.15,283.03], [867.80,277.88], [1117.65,273.89]])
mat2dtest,inlins=cv2.estimateAffine2D(matrix1,matrix2)

#两组3d坐标转换  得到转换矩阵
matrix3 = np.array([[-1.62649994e+02, -2.13050003e+02, 1.64625000e+03], [8.70999985e+01, -2.13449997e+02, 1.65055005e+03], [8.73000031e+01, -1.59499998e+01, 1.63575000e+03],[ 3.36049988e+02, -1.70499992e+01, 1.62850000e+03], [-1.61300003e+02,
       1.34250000e+02, 1.61294995e+03], [8.91500015e+01, 1.32300003e+02,1.61719995e+03],[3.37549988e+02, 1.30399994e+02, 1.61334998e+03]])
matrix4 = np.array([[1,2,30], [4,5,31], [7,8,30],[1,29,30], [4,59,30], [37,8,27],[1,32,28]])
retval, M, inliers=cv2.estimateAffine3D(matrix3,matrix4)


# cv写入yaml文件
cv_file1 = cv2.FileStorage("mat2dtest.yaml", cv2.FILE_STORAGE_WRITE)
print("write matrix\n", mat2dtest)
cv_file1.write("mat2d", mat2dtest)
cv_file1.release()

cv2.destroyAllWindows()

# 标定